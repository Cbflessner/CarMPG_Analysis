data(mtcars)
fit<-glm(mpg~am, data=mtcars, family="quasipoisson")
summary(fit)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(GGally)
cars_num<-mtcars%>%select(mpg, am, disp, hp, drat,wt,qsec)
cars_fac1<-mtcars%>%select(mpg, am, cyl,vs)
cars_fac2<-mtcars%>%select(mpg, am,gear,carb)
cars_num$am<-factor(cars_num$am, labels=c("Auto","Manual"))
cars_fac1$am<-factor(cars_fac1$am, labels=c("Auto","Manual"))
cars_fac2$am<-factor(cars_fac1$am, labels=c("Auto","Manual"))
cars_fac1$cyl<-factor(cars_fac1$cyl)
cars_fac1$vs<-factor(cars_fac1$vs, labels=c("v","s"))
cars_fac2$gear<-factor(cars_fac2$gear)
cars_fac2$carb<-factor(cars_fac2$carb)
cars<-cbind(cars_fac1,cars_fac2[,3:4],cars_num[,3:7])
fit<-glm(mpg~am, data=cars, family="quasipoisson")
summary(fit)
str(cars)
fit1<-glm(mpg~am,family="quasipoisson",data=cars)
fit2<-glm(mpg~am+wt,family="quasipoisson",data=cars)
fit3<-glm(mpg~am+wt+gear,family="quasipoisson",data=cars)
fit4<-glm(mpg~am+wt+gear+cyl,family="quasipoisson",data=cars)
fit5<-glm(mpg~am+wt+gear+cyl+vs,family="quasipoisson",data=cars)
fit6<-glm(mpg~am+wt+gear+cyl+vs+drat,family="quasipoisson",data=cars)
anova(fit1,fit2,fit3,fit4,fit5,fit6, test="Chisq")
summary(fit3)
fit<-glm(mpg~am+wt+gear,family="quasipoisson",data=cars)
exp(coef(fit))
summary(fit)
1-074229
1-.074229
simple<-glm(mpg~am, data=cars, family="quasipoisson")
exp(ceof(simple))
exp(coef(simple))
cars_fac<-mtcars%>%select(mpg, am, cyl,vs,gear,carb)
str(cars_fac)
?mtcars
cars_fac$am<-factor(cars_fac$am, labels=c("Auto","Manual"))
cars_fac$cyl<-factor(cars_fac$cyl)
cars_fac$vs<-factor(cars_fac$vs, labels=c("v","s"))
cars_fac$gear<-factor(cars_fac$gear)
cars_fac$carb<-factor(cars_fac$carb)
str(cars_fac)
g2=ggpairs(cars_fac2, lower = list(combo="blank",discrete="blank"), diag=list(continuous="densityDiag"))
g2=ggpairs(cars_fac, lower = list(combo="blank",discrete="blank"), diag=list(continuous="densityDiag"))
g=ggpairs(cars_fac, lower = list(combo="blank",discrete="blank"), diag=list(continuous="densityDiag"))
g
exp(coef(fit))
exp(coef(fit3))
exp(coef(simple))
fit1<-glm(mpg~am,family="quasipoisson",data=cars)
fit2<-glm(mpg~am+wt,family="quasipoisson",data=cars)
fit3<-glm(mpg~am+wt+gear,family="quasipoisson",data=cars)
fit4<-glm(mpg~am+wt+gear+vs,family="quasipoisson",data=cars)
fit5<-glm(mpg~am+wt+gear+vs+cyl,family="quasipoisson",data=cars)
fit6<-glm(mpg~am+wt+gear+vs+cyl+drat,family="quasipoisson",data=cars)
anova(fit1,fit2,fit3,fit4,fit5,fit6, test="Chisq")
fit1<-glm(mpg~am,family="quasipoisson",data=cars)
fit2<-glm(mpg~am+wt,family="quasipoisson",data=cars)
fit3<-glm(mpg~am+wt+cyl,family="quasipoisson",data=cars)
fit4<-glm(mpg~am+wt+cyl+gear,family="quasipoisson",data=cars)
anova(fit1,fit2,fit3,fit4, test="Chisq")
cyl<-glm(mpg~am+cyl, data=cars, family="quasipoisson")
exp(coef(cyl))
gear<-glm(mpg~am+gear, data=cars, family="quasipoisson")
exp(coef(ggear))
exp(coef(gear))
g=ggpairs(cars_fac, lower = list(combo="blank",discrete="blank"), diag=list(continuous="densityDiag"))
g
fit1<-glm(mpg~am,family="quasipoisson",data=cars)
fit2<-glm(mpg~am+wt,family="quasipoisson",data=cars)
fit3<-glm(mpg~am+wt+vs,family="quasipoisson",data=cars)
fit4<-glm(mpg~am+wt+vs+gear,family="quasipoisson",data=cars)
anova(fit1,fit2,fit3,fit4, test="Chisq")
fit1<-glm(mpg~am,family="quasipoisson",data=cars)
fit2<-glm(mpg~am+wt,family="quasipoisson",data=cars)
fit3<-glm(mpg~am+wt+drat,family="quasipoisson",data=cars)
fit4<-glm(mpg~am+wt+drat+gear,family="quasipoisson",data=cars)
anova(fit1,fit2,fit3,fit4, test="Chisq")
exp(confint(fit))
summary(fit)
summary(fit)$r.squared
summary(simple)r.squared
summary(simple)$r.squared
summary(simple)
simple_lm<-lm(mpg~am, data=cars)
summary(simple_lm)$r.squared
summary(simple_lm)
head(cars)
install.packages("cowplot")
install.packages("car")
install.packages("MASS")
install.packages("MASS")
library(knitr); library(reshape2); library(ggplot2); library(cowplot); library(car); library(MASS)
